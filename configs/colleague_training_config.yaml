# åŒäº‹æ•°æ®é›†è®­ç»ƒé…ç½®
# åŸºäºç°æœ‰çš„patch_training_config.yamlï¼Œé€‚é…ColleagueDatasetAdapter
# 
# ğŸ”§ NEW: å·²å¯ç”¨ç®€å•ç½‘æ ¼ç­–ç•¥ (Simple Grid Patch Strategy)
# ä¼˜åŠ¿: 100%ç¨³å®šæ€§ | å›ºå®š16ä¸ªpatch | æé€Ÿå¤„ç† | æ— å¤æ‚ç®—æ³•
# æ›¿ä»£: å¤æ‚hole detection (19%æ•ˆç‡) â†’ 4x4ç½‘æ ¼ (100%è¦†ç›–)

# æ•°æ®é…ç½®
data:
  data_root: "./data"  # æ•°æ®æ ¹ç›®å½• (åŒ…å«processed_bistro)
  dataset_type: "colleague"  # ä½¿ç”¨ColleagueDatasetAdapter
  data_format: "processed_bistro"  # ğŸ”§ NEW: æŒ‡å®šæ•°æ®æ ¼å¼
  splits:
    train: "train"
    val: "val" 
    test: "test"
  
  # ğŸ”§ NoiseBaseæ•°æ®è·¯å¾„é…ç½®
  processed_bistro_path: "./data/processed_bistro"  # OpenEXRæ•°æ®è·¯å¾„
  required_subdirs: ["warp_hole", "ref", "bistro"]  # å¿…éœ€çš„å­ç›®å½•

# Patchè®­ç»ƒé…ç½®
patch:
  enable_patch_mode: true
  patch_height: 270  # 4x4ç½‘æ ¼åˆ‡åˆ†åçš„patché«˜åº¦ (1080/4)
  patch_width: 480   # 4x4ç½‘æ ¼åˆ‡åˆ†åçš„patchå®½åº¦ (1920/4)  
  patch_size: 270    # ä¿æŒå…¼å®¹æ€§ï¼Œä¸»è¦ç”¨äºå†…å­˜ä¼°ç®—
  patch_mode_probability: 1.0  # ğŸ”§ ä¿®æ”¹ï¼šå§‹ç»ˆä½¿ç”¨patchæ¨¡å¼ä»¥ç¡®ä¿ç®€å•ç½‘æ ¼çš„ä¸€è‡´æ€§
  
  # ğŸ”§ NEW: ç®€å•ç½‘æ ¼ç­–ç•¥é…ç½® (æ¨èç”¨äºè®­ç»ƒç¨³å®šæ€§)
  use_simple_grid_patches: true      # å¯ç”¨ç®€å•4x4ç½‘æ ¼ç­–ç•¥
  use_optimized_patches: false       # ç¦ç”¨å¤æ‚çš„hole detection
  
  # ğŸ”§ ç®€å•ç½‘æ ¼å‚æ•°
  simple_grid_rows: 4                # ç½‘æ ¼è¡Œæ•° (çŸ­è¾¹)
  simple_grid_cols: 4                # ç½‘æ ¼åˆ—æ•° (é•¿è¾¹)
  simple_expected_height: 1080       # é¢„æœŸè¾“å…¥é«˜åº¦
  simple_expected_width: 1920        # é¢„æœŸè¾“å…¥å®½åº¦
  
  # ä¼ ç»Ÿpatchå‚æ•° (ç®€å•ç½‘æ ¼æ¨¡å¼ä¸‹ä¼šè¢«è¦†ç›–)
  min_patches_per_image: 16          # ğŸ”§ ä¿®æ”¹ï¼šå›ºå®š16ä¸ªpatch
  max_patches_per_image: 16          # ğŸ”§ ä¿®æ”¹ï¼šå›ºå®š16ä¸ªpatch
  
  # ç¼“å­˜é…ç½®ï¼ˆç®€å•ç½‘æ ¼æ¨¡å¼ä¸‹æš‚æ—¶ç¦ç”¨ï¼‰
  enable_patch_cache: false
  cache_size: 1000
  
  # æ•°æ®å¢å¼ºï¼ˆç¦ç”¨ä»¥é¿å…é¢œè‰²æ˜ å°„é—®é¢˜ï¼‰
  patch_augmentation: false
  augmentation_probability: 0.0

# ç½‘ç»œé…ç½®
network:
  type: "PatchNetwork"
  input_channels: 7  # ä¿æŒ7é€šé“è¾“å…¥ä¸å˜
  output_channels: 3
  base_channels: 64  # ğŸ”§ NEW: å¢åŠ ç½‘ç»œå®¹é‡ï¼Œbase_channels 24â†’64
  learning_mode: "residual"  # æ®‹å·®å­¦ä¹ æ¨¡å¼
  
  # ğŸ”§ NEW: å¢å¼ºæ¶æ„è¯¦æƒ…
  architecture_details:
    encoder_layers: 5  # 5å±‚ç¼–ç å™¨
    decoder_layers: 5  # 5å±‚è§£ç å™¨
    channel_progression: "64â†’96â†’128â†’192â†’256"  # æ¸è¿›å¼é€šé“å¢é•¿
    boundary_detection: "edge_based"  # è¾¹ç¼˜æ£€æµ‹ï¼ˆä¸æŸå¤±å‡½æ•°å¯¹é½ï¼‰
  
# è®­ç»ƒé…ç½®
training:
  batch_size: 4
  num_workers: 2
  learning_rate: 0.0005  # ç»è¿‡ä¼˜åŒ–çš„å­¦ä¹ ç‡ (5e-4)
  weight_decay: 0.0001  # 1e-4
  max_epochs: 100
  
  # ä¼˜åŒ–å™¨é…ç½®
  optimizer: "AdamW"
  scheduler: "CosineAnnealingLR"
  scheduler_params:
    T_max: 100
    eta_min: 0.000001  # 1e-6

# æŸå¤±å‡½æ•°é…ç½®
loss:
  type: "ResidualInpaintingLoss"
  weights:
    mse: 1.0
    l1: 0.5
    perceptual: 0.8  # æå‡æ„ŸçŸ¥æŸå¤±æƒé‡
    edge: 0.5        # æå‡è¾¹ç¼˜æŸå¤±æƒé‡
    boundary: 0.3
  
  # æ®‹å·®å­¦ä¹ ç‰¹å®šé…ç½®
  residual_scale_factor: 2.0
  spatial_attention: true

# éªŒè¯å’Œç›‘æ§
validation:
  frequency: 5  # æ¯5ä¸ªepochéªŒè¯ä¸€æ¬¡
  metrics: ["mse", "psnr", "ssim"]
  
monitoring:
  tensorboard_log_dir: "./logs/colleague_training"
  model_save_dir: "./models/colleague"
  save_frequency: 10
  
# å†…å­˜ç®¡ç†
memory:
  enable_ultra_safe_mode: true
  max_gpu_memory_gb: 4
  garbage_collection_frequency: 10
